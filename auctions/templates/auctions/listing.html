{% extends "auctions/layout.html" %}

{% block body %}
    <h2>Listing: {{ listing.name }}</h2>
    <img src="{{ listing.image }}">
    <p>{{ listing.description }}</p>
    <h3>${{ listing.price }}</h3>
    {% if listing.active %}
        <p>{{ listing.bidnumber }} bid(s) so far.</p>
        <p>Current bidder: {{ listing.winner }}.</p>
        {% if creator %}
            <form id="close" action="{% url 'listing' listing_id=listing.id%}" method="post">
                {% csrf_token %}
                <input type="submit" value="Close" name='submit-close'>
            </form>
        {% else %}
            <form id="bid" action="{% url 'listing' listing_id=listing.id%}" method="post">
                {% csrf_token %}
                {{ bidForm }}
                <input type="submit" value="Place Bid" name='submit-bid'>
            </form>
        {% endif %}
    {% else %}
        <h4>Closed.</h4>
        <p>Number of bids: {{ listing.bidnumber }}</p>
        <p>Winner: {{ listing.winner }}</p>
    {% endif %}
    <br>
    {% if watching %}
        <form id="stopwatch" action="{% url 'listing' listing_id=listing.id%}" method="post">
            {% csrf_token %}
            <input type="submit" value="Stop Watching" name='submit-stopwatch'>
        </form>
    {% else %}
        <form id="watch" action="{% url 'listing' listing_id=listing.id%}" method="post">
            {% csrf_token %}
            <input type="submit" value="Watch" name='submit-watch'>
        </form>
    {% endif %}
    <br>
    <h4>Details</h4>
    <ul>
        <li>Listed by: {{ id }}</li>
        <li>Category: {{ listing.category }}</li>
    </ul>
    <form id="comment" action="{% url 'listing' listing_id=listing.id%}" method="post">
        {% csrf_token %}
        {{ commentForm }}
        <input type="submit" value="Comment" name='submit-comment'>
    </form>
    {% for comment in comments %}
        <div style="position: relative; width: 1420px; height: 75px; border: 3px solid gray; border-radius: 5px; padding: 10px;">
            <b>{{ comment.commentee }}:</b>
            <p>
                {{ comment.comment }}
            </p>
        </div>
        <br>
    {% endfor %}
{% endblock %}