<!DOCTYPE html>

<html lang="en">
    <head>
        <link href="styles.css" rel="stylesheet">
        <title>Rubik's Cube Simulation</title>
        <script>
            document.addEventListener('DOMContentLoaded', function() {

                const moveHistory = [];

                // All moves
                const moves = ["L", "M", "R", "U", "E", "D", "F", "S", "B"];
                const movesFull = ["L", "M", "R", "U", "E", "D", "F", "S", "B", "L-", "M-", "R-", "U-", "E-", "D-", "F-", "S-", "B-"];

                // Color of faces
                const colors = ["#FFD500", "#FF5800", "#0046AD", "#B71234", "#009B48", "#FFFFFF"];
                const ids = [];
                for(i=0; i<6; i++) {
                    const face = [];
                    for(j=0; j<9; j++) {
                        face[j] = i;
                    }
                    ids[i] = face;
                }

                function draw() {
                    // Top face
                    document.body.innerHTML += "<span style='display: inline-block; width: 186px;'></span>";
                    document.body.innerHTML += "<div id=1 class='cube' style='border-right: 3px solid #000000; border-bottom: 0px;'>";
                    for(var i=0; i<9; i++) {
                        document.getElementById(1).innerHTML += `<div id=1${i} class="square" style="background-color: ${colors[ids[0][i]]} "></div>`;
                    }
                    document.body.innerHTML += "</div>";
                    document.body.innerHTML += "<br>";

                    // Middle faces
                    for(var i=2; i<6; i++) {
                        if(i==5) {
                            document.body.innerHTML += `<div id=${i} class="cube" style="border-right: 3px solid #000000;">`;
                        }
                        else {
                            document.body.innerHTML += `<div id=${i} class="cube">`;
                        }
                        for(var j=0; j<9; j++) {
                            document.getElementById(i).innerHTML += `<div id=${i}${j} class="square" style="background-color: ${colors[ids[i-1][j]]}"></div>`;
                        }
                        document.body.innerHTML += "</div>";
                    }
                    document.body.innerHTML += "<br>";

                    // Bottom face
                    document.body.innerHTML += "<span style='display: inline-block; width: 186px;'></span>";
                    document.body.innerHTML += "<div id=6 class='cube' style='border-right: 3px solid #000000; border-top: 0px; border-bottom: 3px solid #000000;'>";
                    for(var i=0; i<9; i++) {
                        document.getElementById(6).innerHTML += `<div id=6${i} class="square" style="background-color: ${colors[ids[5][i]]}"></div>`;
                    }
                    document.body.innerHTML += "</div>";

                    // Draw the color pickers
                    document.getElementById('bar').innerHTML += "<div class='cube' id='chooser' style='grid-template-columns: 53px 53px 53px 53px 53px 53px; border-right: 4px solid #000000; display:flex;'>";
                    for(let i=0; i<6; i++) {
                        document.getElementById('chooser').innerHTML += `<div id="colorSquare${i}" class="square" style="background-color: ${colors[i]}"></div>`;
                        document.getElementById('chooser').innerHTML += `<input type="color" id="color${i}" name="color${i}" value="${colors[i]}" style="display: none">`;
                    }
                    document.getElementById('bar').innerHTML += "</div>"

                    document.getElementById('bar').innerHTML += "<h1>Hover over the moves to show arrows representing the move, and Click on the moves to move.</h1>";

                    // Draw the move selectors
                    document.getElementById('bar').innerHTML += "<div class='cube' id='movers' style='grid-template-columns: 53px 53px 53px 53px 53px 53px 53px 53px 53px; border-right: 3px solid #000000;'>";
                    for(let q=0; q<moves.length; q++) {
                        document.getElementById('movers').innerHTML += `<div id="${moves[q]}" class="square" style="font-size: 38px;">${moves[q]}</div>`;
                    }
                    for(let q=0; q<moves.length; q++) {
                        document.getElementById('movers').innerHTML += `<div id="${moves[q]}-" class="square" style="font-size: 38px;">${moves[q]}&#39;</div>`;
                    }
                    document.getElementById('bar').innerHTML += "</div>";

                    document.getElementById('bar').innerHTML += "<h1>Buttons for scrambling and solving</h1>";

                    // Draw the scramble and solve buttons
                    document.getElementById('bar').innerHTML += "<div class='cube' id='solvers' style='grid-template-columns: 225px 225px; border-right: 4px solid #000000;'>";
                    document.getElementById('solvers').innerHTML += "<div id='scrambler' class='square' style='aspect-ratio: 5/1; font-size: 38px;'>Scramble</div>";
                    document.getElementById('solvers').innerHTML += "<div id='solver' class='square' style='aspect-ratio: 5/1; display: none; font-size: 38px;'>Solve</div>";
                    document.getElementById('bar').innerHTML += "</div>";
                }
                draw();

                // Add event listners for color pickers
                for(let i=0; i<6; i++) {
                    let button = document.getElementById(`colorSquare${i}`);
                    button.addEventListener('click', function() {
                        let colorPicker = document.getElementById(`color${i}`);
                        colorPicker.style.display = "block";
                        colorPicker.addEventListener('change', function() {
                            colors[i] = colorPicker.value;
                            colorPicker.style.display = "none";
                            button.style.backgroundColor = colors[i];
                            for(let a=1; a<=6; a++) {
                                for(let b=0; b<9; b++) {
                                    if(ids[a-1][b] == i) {
                                        let square = document.getElementById(`${a}${b}`);
                                        square.style.backgroundColor = colors[i];
                                    }
                                }
                            }
                        });
                    });
                }

                function clear() {
                    for(let j=1; j<=6; j++) {
                        for(let k=0; k<9; k++) {
                            document.getElementById(`${j}${k}`).innerHTML = "";
                        }
                    }
                }

                function arrows(face, CW) {
                    if(CW == true) {
                        document.getElementById(face + "0").innerHTML = "↗";
                        document.getElementById(face + "1").innerHTML = "→";
                        document.getElementById(face + "2").innerHTML = "↘";
                        document.getElementById(face + "5").innerHTML = "↓";
                        document.getElementById(face + "8").innerHTML = "↙";
                        document.getElementById(face + "7").innerHTML = "←";
                        document.getElementById(face + "6").innerHTML = "↖";
                        document.getElementById(face + "3").innerHTML = "↑";
                    }
                    else {
                        document.getElementById(face + "0").innerHTML = "↙";
                        document.getElementById(face + "3").innerHTML = "↓";
                        document.getElementById(face + "6").innerHTML = "↘";
                        document.getElementById(face + "7").innerHTML = "→";
                        document.getElementById(face + "8").innerHTML = "↗";
                        document.getElementById(face + "5").innerHTML = "↑";
                        document.getElementById(face + "2").innerHTML = "↖";
                        document.getElementById(face + "1").innerHTML = "←";
                    }
                }

                const LAffected = ["10", "13", "16", "30", "33", "36", "52", "55", "58", "60", "63", "66"];
                const MAffected = ["11", "14", "17", "31", "34", "37", "51", "54", "57", "61", "64", "67"];
                const RAffected = ["12", "15", "18", "32", "35", "38", "50", "53", "56", "62", "65", "68"];
                const UAffected = ["20", "21", "22", "30", "31", "32", "40", "41", "42", "50", "51", "52"];
                const EAffected = ["23", "24", "25", "33", "34", "35", "43", "44", "45", "53", "54", "55"];
                const DAffected = ["26", "27", "28", "36", "37", "38", "46", "47", "48", "56", "57", "58"];
                const FAffected = ["16", "17", "18", "22", "25", "28", "40", "43", "46", "60", "61", "62"];
                const SAffected = ["13", "14", "15", "21", "24", "27", "41", "44", "47", "63", "64", "65"];
                const BAffected = ["10", "11", "12", "20", "23", "26", "42", "45", "48", "66", "67", "68"];

                // Add hover event listners for movers
                for(let q=0; q<movesFull.length; q++) {
                    let button = document.getElementById(`${movesFull[q]}`);
                    button.addEventListener('mouseover', function() {
                        clear();
                        if(movesFull[q]=="L" || movesFull[q]=="L-") {
                            for(let j=0; j<LAffected.length; j++) {
                                if((j>=6 && j<=8 && movesFull[q]=="L") || ((j<6 || j>8) && movesFull[q]=="L-")) { document.getElementById(LAffected[j]).innerHTML = "↑"; }
                                else { document.getElementById(LAffected[j]).innerHTML = "↓"; }
                            }
                            if(movesFull[q]=="L") {
                                arrows(2, true);
                            }
                            else {
                                arrows(2, false);
                            }
                        }
                        if(movesFull[q]=="M" || movesFull[q]=="M-") {
                            for(let j=0; j<MAffected.length; j++) {
                                if((j>=6 && j<=8 && movesFull[q]=="M") || ((j<6 || j>8) && movesFull[q]=="M-")) { document.getElementById(MAffected[j]).innerHTML = "↑"; }
                                else { document.getElementById(MAffected[j]).innerHTML = "↓"; }
                            }
                        }
                        if(movesFull[q]=="R" || movesFull[q]=="R-") {
                            for(let j=0; j<RAffected.length; j++) {
                                if((j>=6 && j<=8 && movesFull[q]=="R") || ((j<6 || j>8) && movesFull[q]=="R-")) { document.getElementById(RAffected[j]).innerHTML = "↓"; }
                                else { document.getElementById(RAffected[j]).innerHTML = "↑"; }
                            }
                            if(movesFull[q]=="R") {
                                arrows(4, true);
                            }
                            else {
                                arrows(4, false);
                            }
                        }
                        if(movesFull[q]=="U" || movesFull[q]=="U-") {
                            for(let j=0; j<UAffected.length; j++) {
                                if(movesFull[q]=="U") { document.getElementById(UAffected[j]).innerHTML = "←"; }
                                else { document.getElementById(UAffected[j]).innerHTML = "→"; }
                            }
                            if(movesFull[q]=="U") {
                                arrows(1, true);
                            }
                            else {
                                arrows(1, false);
                            }
                        }
                        if(movesFull[q]=="E" || movesFull[q]=="E-") {
                            for(let j=0; j<EAffected.length; j++) {
                                if(movesFull[q]=="E") { document.getElementById(EAffected[j]).innerHTML = "→"; }
                                else { document.getElementById(EAffected[j]).innerHTML = "←"; }
                            }
                        }
                        if(movesFull[q]=="D" || movesFull[q]=="D-") {
                            for(let j=0; j<DAffected.length; j++) {
                                if(movesFull[q]=="D") { document.getElementById(DAffected[j]).innerHTML = "→"; }
                                else { document.getElementById(DAffected[j]).innerHTML = "←"; }
                            }
                            if(movesFull[q]=="D") {
                                arrows(6, true);
                            }
                            else {
                                arrows(6, false);
                            }
                        }
                        if(movesFull[q]=="F" || movesFull[q]=="F-") {
                            for(let j=0; j<FAffected.length; j++) {
                                if((j>=0 && j<=2 && movesFull[q]=="F") || (j>=9 && movesFull[q]=="F-")) { document.getElementById(FAffected[j]).innerHTML = "→"; }
                                else if((j>=3 && j<=5 && movesFull[q]=="F") || (j>=6 && j<=8 && movesFull[q]=="F-")){ document.getElementById(FAffected[j]).innerHTML = "↑"; }
                                else if((j>=6 && j<=8 && movesFull[q]=="F") || (j>=3 && j<=5 && movesFull[q]=="F-")){ document.getElementById(FAffected[j]).innerHTML = "↓"; }
                                else { document.getElementById(FAffected[j]).innerHTML = "←"; }
                            }
                            if(movesFull[q]=="F") {
                                arrows(3, true);
                            }
                            else {
                                arrows(3, false);
                            }
                        }
                        if(movesFull[q]=="S" || movesFull[q]=="S-") {
                            for(let j=0; j<SAffected.length; j++) {
                                if((j>=0 && j<=2 && movesFull[q]=="S") || (j>=9 && movesFull[q]=="S-")) { document.getElementById(SAffected[j]).innerHTML = "→"; }
                                else if((j>=3 && j<=5 && movesFull[q]=="S") || (j>=6 && j<=8 && movesFull[q]=="S-")){ document.getElementById(SAffected[j]).innerHTML = "↑"; }
                                else if((j>=6 && j<=8 && movesFull[q]=="S") || (j>=3 && j<=5 && movesFull[q]=="S-")){ document.getElementById(SAffected[j]).innerHTML = "↓"; }
                                else { document.getElementById(SAffected[j]).innerHTML = "←"; }
                            }
                        }
                        if(movesFull[q]=="B" || movesFull[q]=="B-") {
                            for(let j=0; j<BAffected.length; j++) {
                                if((j>=0 && j<=2 && movesFull[q]=="B") || (j>=9 && movesFull[q]=="B-")) { document.getElementById(BAffected[j]).innerHTML = "←"; }
                                else if((j>=3 && j<=5 && movesFull[q]=="B") || (j>=6 && j<=8 && movesFull[q]=="B-")){ document.getElementById(BAffected[j]).innerHTML = "↓"; }
                                else if((j>=6 && j<=8 && movesFull[q]=="B") || (j>=3 && j<=5 && movesFull[q]=="B-")){ document.getElementById(BAffected[j]).innerHTML = "↑"; }
                                else { document.getElementById(BAffected[j]).innerHTML = "→"; }
                            }
                            if(movesFull[q]=="B") {
                                arrows(5, true);
                            }
                            else {
                                arrows(5, false);
                            }
                        }
                    });
                }

                const squares = [];
                squares[0] = [4, 8, 4, 5, 4, 2, 5, 0, 5, 3, 5, 6, 2, 0, 2, 3, 2, 6, 0, 0, 0, 3, 0, 6, 1, 3, 1, 7, 1, 5, 1, 1, 1, 6, 1, 8, 1, 2, 1, 0]; // L
                squares[1] = [4, 7, 4, 4, 4, 1, 5, 1, 5, 4, 5, 7, 2, 1, 2, 4, 2, 7, 0, 1, 0, 4, 0, 7]; // M
                squares[2] = [0, 2, 0, 5, 0, 8, 2, 2, 2, 5, 2, 8, 5, 2, 5, 5, 5, 8, 4, 6, 4, 3, 4, 0, 3, 3, 3, 7, 3, 5, 3, 1, 3, 6, 3, 8, 3, 2, 3, 0]; // R
                squares[3] = [1, 0, 1, 1, 1, 2, 2, 0, 2, 1, 2, 2, 3, 0, 3, 1, 3, 2, 4, 0, 4, 1, 4, 2, 0, 3, 0, 7, 0, 5, 0, 1, 0, 6, 0, 8, 0, 2, 0, 0]; // U
                squares[4] = [4, 3, 4, 4, 4, 5, 3, 3, 3, 4, 3, 5, 2, 3, 2, 4, 2, 5, 1, 3, 1, 4, 1, 5]; // E
                squares[5] = [4, 6, 4, 7, 4, 8, 3, 6, 3, 7, 3, 8, 2, 6, 2, 7, 2, 8, 1, 6, 1, 7, 1, 8, 5, 3, 5, 7, 5, 5, 5, 1, 5, 6, 5, 8, 5, 2, 5, 0]; // D
                squares[6] = [0, 6, 0, 7, 0, 8, 1, 8, 1, 5, 1, 2, 5, 2, 5, 1, 5, 0, 3, 0, 3, 3, 3, 6, 2, 3, 2, 7, 2, 5, 2, 1, 2, 6, 2, 8, 2, 2, 2, 0]; // F
                squares[7] = [0, 3, 0, 4, 0, 5, 1, 7, 1, 4, 1, 1, 5, 5, 5, 4, 5, 3, 3, 1, 3, 4, 3, 7]; // S
                squares[8] = [3, 2, 3, 5, 3, 8, 5, 8, 5, 7, 5, 6, 1, 6, 1, 3, 1, 0, 0, 0, 0, 1, 0, 2, 4, 3, 4, 7, 4, 5, 4, 1, 4, 6, 4, 8, 4, 2, 4, 0]; // B
                squares[9] = [0, 0, 0, 3, 0, 6, 2, 0, 2, 3, 2, 6, 5, 0, 5, 3, 5, 6, 4, 8, 4, 5, 4, 2, 1, 0, 1, 2, 1, 8, 1, 6, 1, 1, 1, 5, 1, 7, 1, 3]; // L-
                squares[10] = [0, 1, 0, 4, 0, 7, 2, 1, 2, 4, 2, 7, 5, 1, 5, 4, 5, 7, 4, 7, 4, 4, 4, 1]; // M-
                squares[11] = [4, 6, 4, 3, 4, 0, 5, 2, 5, 5, 5, 8, 2, 2, 2, 5, 2, 8, 0, 2, 0, 5, 0, 8, 3, 0, 3, 2, 3, 8, 3, 6, 3, 1, 3, 5, 3, 7, 3, 3]; // R-
                squares[12] = [4, 0, 4, 1, 4, 2, 3, 0, 3, 1, 3, 2, 2, 0, 2, 1, 2, 2, 1, 0, 1, 1, 1, 2, 0, 0, 0, 2, 0, 8, 0, 6, 0, 1, 0, 5, 0, 7, 0, 3]; // U-
                squares[13] = [1, 3, 1, 4, 1, 5, 2, 3, 2, 4, 2, 5, 3, 3, 3, 4, 3, 5, 4, 3, 4, 4, 4, 5]; // E-
                squares[14] = [1, 6, 1, 7, 1, 8, 2, 6, 2, 7, 2, 8, 3, 6, 3, 7, 3, 8, 4, 6, 4, 7, 4, 8, 5, 0, 5, 2, 5, 8, 5, 6, 5, 1, 5, 5, 5, 7, 5, 3]; // D-
                squares[15] = [3, 0, 3, 3, 3, 6, 5, 2, 5, 1, 5, 0, 1, 8, 1, 5, 1, 2, 0, 6, 0, 7, 0, 8, 2, 0, 2, 2, 2, 8, 2, 6, 2, 1, 2, 5, 2, 7, 2, 3]; // F-
                squares[16] = [3, 1, 3, 4, 3, 7, 5, 5, 5, 4, 5, 3, 1, 7, 1, 4, 1, 1, 0, 3, 0, 4, 0, 5]; // S-
                squares[17] = [0, 0, 0, 1, 0, 2, 1, 6, 1, 3, 1, 0, 5, 8, 5, 7, 5, 6, 3, 2, 3, 5, 3, 8, 4, 0, 4, 2, 4, 8, 4, 6, 4, 1, 4, 5, 4, 7, 4, 3]; // B-

                function move(side) {
                    // Cycle the 12 rims
                    let original3 = [ids[squares[side][0]][squares[side][1]], ids[squares[side][2]][squares[side][3]], ids[squares[side][4]][squares[side][5]]];
                    for(let i=0; i<9; i++) {
                        ids[squares[side][2*i]][squares[side][2*i+1]] = ids[squares[side][2*(i+3)]][squares[side][2*(i+3)+1]];
                        let square = document.getElementById(`${squares[side][2*i]+1}${squares[side][2*i+1]}`);
                        square.style.backgroundColor = colors[ids[squares[side][2*i]][squares[side][2*i+1]]];
                    }
                    for(let i=0; i<3; i++) {
                        ids[squares[side][18+2*i]][squares[side][19+2*i]] = original3[i];
                        let square = document.getElementById(`${squares[side][18+2*i]+1}${squares[side][19+2*i]}`);
                        square.style.backgroundColor = colors[ids[squares[side][18+2*i]][squares[side][19+2*i]]];
                    }

                    if(squares[side].length == 40) {
                        // Cycle the 4 corners
                        let originalCorner = ids[squares[side][24]][squares[side][25]];
                        for(let i=12; i<15; i++) {
                            ids[squares[side][2*i]][squares[side][2*i+1]] = ids[squares[side][2*i+2]][squares[side][2*i+3]];
                            let square = document.getElementById(`${squares[side][2*i]+1}${squares[side][2*i+1]}`);
                            square.style.backgroundColor = colors[ids[squares[side][2*i]][squares[side][2*i+1]]];
                        }
                        ids[squares[side][30]][squares[side][31]] = originalCorner;
                        let square = document.getElementById(`${squares[side][30]+1}${squares[side][31]}`);
                        square.style.backgroundColor = colors[ids[squares[side][30]][squares[side][31]]];

                        // Cycle the 4 edges
                        let originalEdge = ids[squares[side][32]][squares[side][33]];
                        for(let i=16; i<19; i++) {
                            ids[squares[side][2*i]][squares[side][2*i+1]] = ids[squares[side][2*i+2]][squares[side][2*i+3]];
                            let square = document.getElementById(`${squares[side][2*i]+1}${squares[side][2*i+1]}`);
                            square.style.backgroundColor = colors[ids[squares[side][2*i]][squares[side][2*i+1]]];
                        }
                        ids[squares[side][38]][squares[side][39]] = originalEdge;
                        square = document.getElementById(`${squares[side][38]+1}${squares[side][39]}`);
                        square.style.backgroundColor = colors[ids[squares[side][38]][squares[side][39]]];
                    }

                    moveHistory.push(side);

                    // Check if the cube is solved
                    let solved = true;
                    for(let i=0; i<6; i++) {
                        for(let j=1; j<9; j++) {
                            if(ids[i][0] != ids[i][j]) {
                                solved = false;
                            }
                        }
                    }
                    if(solved == true) {
                        document.getElementById("solver").style.display = "none";
                        document.getElementById("scrambler").style.display = "block";
                        moveHistory = [];
                    }
                    else {
                        document.getElementById("solver").style.display = "block";
                        document.getElementById("scrambler").style.display = "none";
                    }
                }

                // Add click event listners for movers
                for(let q=0; q<movesFull.length; q++) {
                    let button = document.getElementById(`${movesFull[q]}`);
                    button.addEventListener('click', function() {
                        move(q);
                    });
                }

                // Add click event listner for scrambler
                document.getElementById("scrambler").addEventListener('click', function() {
                    let i = 0;
                    function scramble() {
                        setTimeout(function() {
                            let random = Math.random();
                            if(random < 1/18) { move(0); }
                            else if(random < 2/18) { move(1); }
                            else if(random < 3/18) { move(2); }
                            else if(random < 4/18) { move(3); }
                            else if(random < 5/18) { move(4); }
                            else if(random < 6/18) { move(5); }
                            else if(random < 7/18) { move(6); }
                            else if(random < 8/18) { move(7); }
                            else if(random < 9/18) { move(8); }
                            else if(random < 10/18) { move(9); }
                            else if(random < 11/18) { move(10); }
                            else if(random < 12/18) { move(11); }
                            else if(random < 13/18) { move(12); }
                            else if(random < 14/18) { move(13); }
                            else if(random < 15/18) { move(14); }
                            else if(random < 16/18) { move(15); }
                            else if(random < 17/18) { move(16); }
                            else { move(17); }
                            i++;
                            if (i < 40) {
                                scramble();
                            }
                        }, 50)
                    }
                    scramble();
                });

                // Add click event listner for solver
                document.getElementById("solver").addEventListener('click', function() {
                    function solve() {
                        setTimeout(function() {
                            move((moveHistory.pop()+9)%18);
                            moveHistory.pop()
                            if (moveHistory.length != 0) {
                                solve();
                            }
                        }, 50)
                    }
                    solve();
                });
            });
        </script>
    </head>
    <body style="background-color: #ADD8E6;">
        <div id='bar' style='float: right; width: 40%; background-color: #CFB284; padding: 40px; padding-top: 10px'>
            <h1>Change the color by clicking on a color and using the color picker!</h1>
        </div>
    </body>
</html>